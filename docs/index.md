---
# generated by terraform-provider-spirl/templates/index.md.tmpl
# Run `mise run generate:terraform-docs` to update the generated file
page_title: "Provider: Spirl"
description: |-
  The Spirl provider is used to interact with the resources supported by Spirl.
---

# SPIRL Provider

The Spirl Terrform provider allows you to manage resources in your Spirl environment.

## Quickstart

1. Requirements
- [Terraform](https://www.terraform.io/downloads.html) >= 1.0
- [Spirl CLI](https://d.spirl.com/category/quick-start)
- An existing trust domain created within Spirl.

2. Create a Service Account for use with Terraform. This will create a new service account named `terra` with the `admin` role.
See the [Spirl AIM Roles](https://d.spirl.com/iam/roles) for more information on the access permissions each role grans.

```shell
spirlctl iam service-account create terra --role-name admin
```

3. Create an access key for the service account. This will create a new access key for the service account `terra`.
Save the private key to a secure location as it will not be retrievable after creation.

```shell
spirlctl iam service-account key add --service-account terra
```

4. Configure the Terraform provider by creating a `main.tf` file with the following content:

```terraform
provider "spirl" {
  sa_key_id      = "sak-abcd1234"
  sa_private_key = file("path/to/private-key.pem")
}
```

Note: Replace the key id and private key with the values from the access key created in step 3.

```terraform
# An existing SPIRL trust domain can be retrieved by providing the domain name of the trust domain. The configuration of the trust domain is available as read-only fields on the data item as demonstrated below.

data "spirl_trust_domain" "existing_domain" {
  domain_name = "example.com"
}

output "agent_endpoint" {
  value = data.spirl_trust_domain.existing_domain.spirl_agent_endpoint
}
```

Note: Replace `example.com` with the domain of your trust domain.


5. Initialize Terraform and apply the configuration.

```shell
terraform init
terraform apply
```

## Provider Configuration

### Standard Configuration

```terraform
provider "spirl" {
  sa_key_id      = "sak-abcd1234"
  sa_private_key = file("path/to/private-key.pem")
}
```

### Environment Variables

```terraform
# If using enviornment variables to set the service account key ID and private key, use an empty provider block:
# export SPIRL_SA_KEY_ID="sak-abcd1234"
# export SPIRL_SA_PRIVATE_KEY=$(cat path/to/private-key.pem)
provider "spirl" {}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `endpoint` (String) The SPIRL control plane endpoint and port (default: api.spirl.com:443)
- `sa_key_id` (String) The key ID for the SPIRL service account. Alternatively provide via the SPIRL_SA_KEY_ID environment variable.
- `sa_private_key` (String, Sensitive) The private key for the SPIRL service account. Alternatively provide via the SPIRL_SA_PRIVATE_KEY environment variable. _Never commit your private key contents to Terraform configuration (use file() or environment variable)._
- `spirlctl_config_path` (String) The path to the configuration file used to store spirlctl login. (Default: ~/.spirl/config.json)
- `use_tls` (Boolean) Whether or not to use TLS to the SPIRL control plane (default: true)

## Signing Keys

This terraform provider is signed. If you are cloning the provider into you're own repository and require a copy of the public key, you can find a copy in the OpenTOFU Registry at [https://github.com/opentofu/registry/tree/main/keys/s/spirl/spirl](https://github.com/opentofu/registry/tree/main/keys/s/spirl/spirl)
